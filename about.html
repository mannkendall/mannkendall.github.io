

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spirit of mannkendall &mdash; mannkendall  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="#" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledging mannkendall" href="acknowledge.html" />
    <link rel="prev" title="mannkendall" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> mannkendall
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Spirit of mannkendall</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-problem-of-autocorrelation-in-the-mann-kendall-test">The problem of autocorrelation in the Mann-Kendall test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description-of-the-prewhitening-methods">Description of the prewhitening methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-of-the-seasonal-mann-kendall-test">Application of the seasonal Mann-Kendall test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://mannkendall.github.io/Matlab">Matlab</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mannkendall.github.io/R">R</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mannkendall.github.io/Python">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledge.html">Acknowledging mannkendall</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mannkendall</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Spirit of mannkendall</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/about.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spirit-of-mannkendall">
<h1>Spirit of mannkendall<a class="headerlink" href="#spirit-of-mannkendall" title="Permalink to this headline">¶</a></h1>
<p>What follows is a high-level – <strong>language-agnostic !</strong> – description of the mannkendall code.</p>
<p><strong>Topics:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#summary"><span class="std std-ref">Summary</span></a></p></li>
<li><p><a class="reference internal" href="#introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#the-problem-of-autocorrelation-in-the-mann-kendall-test"><span class="std std-ref">The problem of autocorrelation in the Mann-Kendall test</span></a></p></li>
<li><p><a class="reference internal" href="#description-of-the-prewhitening-methods"><span class="std std-ref">Description of the prewhitening methods</span></a></p></li>
<li><p><a class="reference internal" href="#application-of-the-seasonal-mann-kendall-test"><span class="std std-ref">Application of the seasonal Mann-Kendall test</span></a></p></li>
<li><p><a class="reference internal" href="#references"><span class="std std-ref">References</span></a></p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the specific usage instructions of mannkendall, see the:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://mannkendall.github.io/Matlab">Matlab pages</a></p></li>
<li><p><a class="reference external" href="https://mannkendall.github.io/R">R pages</a></p></li>
<li><p><a class="reference external" href="https://mannkendall.github.io/Python">Python pages</a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The mannkendall code implements the Mann-Kendall statistical test associated with the Sen’s slope,
following the prescriptions of:</p>
<p><em>M. Collaud Coen, E. Andrews, G. Romanens, G. Martucci and L. Vuilleumier, Effects of the
prewhitening method, the time granularity and the time segmentation on the Mann-Kendall trend
detection and the associated Sen’s slope, Atm. Meas. Techn. Discuss., 2020</em>,
<a class="reference external" href="https://doi.org/10.5194/amt-2020-178">https://doi.org/10.5194/amt-2020-178</a>.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Mann-Kendall (MK) test associated with the Sen’s slope is the most widely applied non-parametric
trend analysis method in atmospheric and hydrologic research (Gilbert, 1987; Sirois, 1998). While it
has no requirement on data distribution, it must be applied on serially independent and identically
distributed variables.</p>
<p>The second condition of homogeneity of distribution is not met if a seasonality is present, but it
can be solved by using the seasonal Mann-Kendall test developed by Hirsch et al. (1982). The first
condition of independence is not met if the data are autocorrelated. Algorithms were developed to
reduce the impact of the autocorrelation artefacts on the statistical significance of the MK test,
and on the Sen’s slope. Two kinds of algorithms are usually used:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the prewhitening of the data to remove the autocorrelation, and</p></li>
<li><p>the inflation of the variance of the trend test statistic to take into account the number of
independent measurements instead of the number of data points (the autocorrelation reduces the
number of degrees of freedom in tests).</p></li>
</ol>
</div></blockquote>
<p>The mannkendall code includes several prewhitening methods, following the prescriptions of Collaud
Coen et al. (2020).</p>
</div>
<div class="section" id="the-problem-of-autocorrelation-in-the-mann-kendall-test">
<h2>The problem of autocorrelation in the Mann-Kendall test<a class="headerlink" href="#the-problem-of-autocorrelation-in-the-mann-kendall-test" title="Permalink to this headline">¶</a></h2>
<p>The MK test determines the validity of the null hypothesis H0 of the absence of a trend against the
alternative hypothesis H1 of the existence of a monotonic continuous trend. While no assumptions are
needed about the data distribution (i.e., the definition of a non-parametric test), the MK test does
require that the data are serially independent, namely the absence of autocorrelation in the time
series.</p>
<p>Statistical tests are prone to two types of error. The first is an incorrect rejection of the null
hypothesis H0, called a <em>type 1 error</em>. This error is related to a too high statistical significance
leading to false positive cases. The second is an incorrect acceptance of the null hypothesis H0,
called a <em>type 2 error</em>. This error can be understood as the power of the test being too low,
leading to false negative cases.</p>
<p>It was shown that positive autocorrelation in time series largely increases the number of type 1
errors, whereas prewhitening procedures increase the number of type 2 errors. Larger lag-1
autocorrelation (ak1) leads to higher percentage of type 1 errors and to a larger bias in the Sen’s
slope.</p>
</div>
<div class="section" id="description-of-the-prewhitening-methods">
<h2>Description of the prewhitening methods<a class="headerlink" href="#description-of-the-prewhitening-methods" title="Permalink to this headline">¶</a></h2>
<p>Five different prewhitening methods have been implemented in the mannkendall code:</p>
<blockquote>
<div><ol class="arabic">
<li><p><strong>PW:</strong> simple prewhitening method (Kulkarni and von Stroch, 1995). PW simply removes the
lag-1 autocorrelation from the original data. This PW method results in a low amount of type
1 errors, but the existence of real trends, either positive or negative, can lead to an
over-/underestimation of ak1, which will reduces the power of the test.</p></li>
<li><p><strong>TFPW_Y:</strong> trend free prewhitening method (Yue et al., 2002). TFPW_Y remove the
autocorrelation on detrended data. TFPW_Y consists of:</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>estimating the Sen’s slope β on the original data</p></li>
<li><p>removing the trend to obtain a detrended time series</p></li>
<li><p>removing the lag-1 autocorrelation to generate a detrended prewhitened time series</p></li>
<li><p>adding the trend back in to generate the processed time series to evaluate.</p></li>
</ol>
</div></blockquote>
<p>TFPW-Y restores the power of the test, albeit at the expense of an increase number of type 1
errors.</p>
</li>
<li><p><strong>TFPW_WS:</strong> trend free prewhitening method (Wang and Swail, 2001). TFPW_WS is an iterative
TFPW method to mitigate the adverse effect of trend on the accuracy of the lag-1
autocorrelation estimate. TFPW_WS consist of:</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>removing the lag-1 autocorrelation from the original time series and correcting the
prewhitened data for the modified mean</p></li>
<li><p>estimating the Sen’s slope on the prewhitened data</p></li>
<li><p>removing the trend estimated on the PW data from the original data to obtain a
prewhitened detrended time series</p></li>
<li><p>applying iteratively steps (i)-(iii) until the lag-a and slope differences become
smaller than a proposed tiny threshold. TFPW_WS restores the low number of type 1
errors without decreasing the power of the test.</p></li>
</ol>
</div></blockquote>
</li>
<li><p><strong>VCTFPW:</strong> variance corrected trend free prewhitening method (Wang et al., 2015). VCTFPW aims
to correct TFPW-Y for both the elevated variance of slope estimators and for the decreased
slope caused by the prewhitening. VCTFPW consists of the variance of the original data
restored on the TFPW data. VCTFPW leads to more accurate slope estimators, preserves to some
extent the power of the test but only mitigates the type 1 errors.</p></li>
<li><p><strong>3PW:</strong> three prewhitening methods combined following the prescriptions of Collaud Coen et al.
(2020). 3PW uses PW and TFPW_Y to determine the statistical significance of the Mann-Kendall
test and VCTFPW to estimate the Sen’s slope. 3PW combines the advantages of these prewhitening
methods, i.e.:</p>
<blockquote>
<div><ul class="simple">
<li><p>the low type 1 error for PW,</p></li>
<li><p>the high-test power for TFPW-Y, and</p></li>
<li><p>the unbiased slope estimate for VCTFPW.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>The mannkendall code is very much intended to be used with the 3PW method. However, all others can
also be easily accessed if required. A more detailed explanation of these 5 prewhitening methods,
including their mathematical descriptions, can be found in Collaud Coen et al. (2020).</p>
</div>
<div class="section" id="application-of-the-seasonal-mann-kendall-test">
<h2>Application of the seasonal Mann-Kendall test<a class="headerlink" href="#application-of-the-seasonal-mann-kendall-test" title="Permalink to this headline">¶</a></h2>
<p>The MK test for trends is a non-parametric method based on rank. Here’s the general mechanism behind
the high-level function of mannkendall:</p>
<blockquote>
<div><ul class="simple">
<li><p>The calculated S statistic is normally distributed for a number of observation N&gt;10 and the
significance of the trends is tested by comparing the standardized test statistic
Z=S/[var(S)]^0.5 with the standard normal variate at the desired significance level.
For N≤10, an exact S distribution is applied (see e.g., Gilbert, 1987). The default
confidence level for the Mann-Kendall test (<cite>alpha_MK</cite>) is 95% in the mannkendall code.</p></li>
<li><p>Hirsch et al. (1982) extend the Mann-Kendall test to take temporal aggregation in the data
into account as well as multiple observations for each temporal aggregation. A global or
annual trend can be considered only if the trends are homogeneous at the desired confidence
level (Gilbert, 1987). Consequently, <strong>the annual trend is reported only if the trends for
each temporal aggregation are homogeneous</strong>. The default confidence level (<cite>alpha_Xhomo</cite>) is
90% in the mannkendall code.</p></li>
<li><p>Confidence limits (CL) are defined as the 100*(1-p) percentiles of the standard normal
distribution of all the pairwise slopes computed during the Sen’s slope estimator, where p is
the chosen confidence limit. The default confidence level of the confidence limits
(<cite>alpha_CL</cite>) is 90% in the mannkendall code.</p></li>
<li><p>The prewhitening methods are applied only if the first lag autocorrelation coefficient (ak1)
is statistically significant (ss) following a normal distribution at the two-sided test at
the desired confidence interval. The default confidence level (<cite>alpha_ak</cite>) is 95% in the
mannkendall code.</p></li>
<li><p>The lag-1 autocorrelation is computed from the whole time series, whatever the temporal
aggregation.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><em>M. Collaud Coen, E. Andrews, G. Romanens, G. Martucci and L. Vuilleumier, Effects of the
prewhitening method, the time granularity and the time segmentation on the Mann-Kendall trend
detection and the associated Sen’s slope, Atm. Meas. Techn. Discuss., 2020.</em>
<a class="reference external" href="https://doi.org/10.5194/amt-2020-178">https://doi.org/10.5194/amt-2020-178</a></p>
<p><em>Gilbert, R. O.: Statistical Methods for Environmental Pollution Monitoring, Van Nostrand Reinhold
Company, New York, 1987.</em></p>
<p><em>Hirsch, R. M., Slack, J. R., and Smith, R. A. : Techniques of trend analysis for monthly water
quality data, Water Resour. Res., 18,107–121, 1982.</em></p>
<p><em>Kulkarni, A., and von Storch, H.: Monte Carlo Experiments on the Effect of Serial Correlation on
the Mann-Kendall Test of Trend Monte Carlo experiments on the effect, Meteorologische Zeitschrift,
82–85, 1995.</em></p>
<p><em>Sirois, A.: A brief and biased overview of time-series analysis of how to find that evasive trend,
WMO/EMEP Workshop on Advanced Statistical Methods and Their Application to Air Quality Data Sets,
Annex E., Global Atmosphere Watch No. 133, TD- No. 956, World Meteorological Organization, Geneva,
Switzerland, 1998.</em></p>
<p><em>Wang, W., Chen, Y., Becker, S., and Liu, B.: Linear trend detection in serially dependent
hydrometeorological data based on a variance correction Spearman rho method, Water, 7(12),
7045–7065, 2015.</em>. <a class="reference external" href="https://doi.org/10.3390/w7126673">https://doi.org/10.3390/w7126673</a></p>
<p><em>Wang, X. L. and Swail, V. R: Changes of extreme wave heights in Northern Hemisphere oceans and
related atmospheric circulation regimes, J. Climate, 14, 2204–2221, 2001.</em>
<a class="reference external" href="https://doi.org/10.1175/1520-0442(2001)014">https://doi.org/10.1175/1520-0442(2001)014</a></p>
<p><em>Yue, S., Pilon, P., Phinney, B., and Cavadias, G.: The influence of autocorrelation on the ability
to detect trend in hydrological series, Hydrol. Process., 16(9), 1807–1829, 2002.</em>
<a class="reference external" href="https://doi.org/10.1002/hyp.1095">https://doi.org/10.1002/hyp.1095</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="acknowledge.html" class="btn btn-neutral float-right" title="Acknowledging mannkendall" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="mannkendall" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, MeteoSwiss.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>